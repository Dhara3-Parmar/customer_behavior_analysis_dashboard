CUSTOMER_SHOPPING_BEHAVIOUR_ANALYSIS


TOOLS USED %%%%%%%%%%%%%%%5
  1.ANACONDA NAVIGATOR-JUPITER NOTEBOOK
=(for data cleaning and add colume and show data)

  2.PGADMIN(password=admin,serverPorter=3388)
=(postgresql database ko manage karne ke liye)
=(pgAdmin sirf 1 chehra he database ko dekhne ke liye 
iske piche asli kam postgreserver hota he)

Problem Statement

A leading retail company wants to better understand its customers’ shopping behavior in order to improve sales, customer satisfaction, and long-term loyalty. The management team has noticed changes in purchasing patterns across demographics, product categories, and sales channels (online vs. offline). They are particularly interested in uncovering which factors, such as discounts, reviews, seasons, or payment preferences, drive consumer decisions and repeat purchases.
You are tasked with analyzing the company’s consumer behavior dataset to answer the following overarching business question:
“How can the company leverage consumer shopping data to identify trends, improve customer engagement, and optimize marketing and product strategies?”


///THIS ISS THE FILE WHERE ALL DATASET IS PUT ON
THIS IS  IN EXCEL
customer_shopping_behavior.csv



***1st step is cleaning the data

in a jupiter which is in (current folder: C:\Users\Admin)

open it and write this command...
1.
import pandas as pd
import os
print("current folder:",os.getcwd())

2.df.describe()

3.df.isnull().sum()

4.df['Review Rating']=df.groupby('Category')['Review Rating'].transform(lambda x: x.fillna(x.median()))

5.df.isnull().sum()


import pandas as pd
df=pd.read_csv('customer_shopping_behavior.csv')

df.head()

df.info()

df.describe()

df.describe(include='all')

df.isnull().sum()

df['Review Rating']=df.groupby('Category')['Review Rating'].transform(lambda x:x.fillna(x.median()))
df.isnull().sum()

df.columns=df.columns.str.lower()
df.columns=df.columns.str.replace(' ','_')
df=df.rename(columns={'purchase_amount_(usd)':'purchase_amount'})

df.columns



*********************THIS IS COMPLITE THE DATA CLEANING*********************

**********create colume**********************
1st
#create a colume age age_group
labels=['Younge Adult','Adult','Middle-aged','senior']
df['age_group']=pd.qcut(df['age'],q=4,labels=labels)

df[['age','age_group']].head(10)



2nd
#create a colume purchase_frequency_days

frequency_mapping={
    'Fortnightly':14,
    'weekly':7,
    'Monthly':30,
    'Quarterly':90,
    'Bi-weekly':14,
    'Annually':365,
    'Every 3 Months':90
}
df['purchase_frequency_days']=df['frequency_of_purchases'].map(frequency_mapping)

df[['purchase_frequency_days','frequency_of_purchases']].head(10)


////if promo code is yes then discount is applied
df[['discount_applied','promo_code_used']].head(10)


////both values are carry exact same values
(df['discount_applied']==df['promo_code_used']).all()



df=df.drop('promo_code_used',axis=1)
df.columns

output:
Index(['customer_id', 'age', 'gender', 'item_purchased', 'category',
       'purchase_amount', 'location', 'size', 'color', 'season',
       'review_rating', 'subscription_status', 'shipping_type',
       'discount_applied', 'previous_purchases', 'payment_method',
       'frequency_of_purchases', 'age_group', 'purchase_frequency_days'],
      dtype='object')

******************Dataset Overview in Excel**************

import pandas as pd
df=pd.read_csv('customer_shopping_behavior.csv')

df.head()


****************************Dataset Overview in Excel************************

insertquery=product(name=name,cat_type= Category(id=cat_type),price=price,desc=desc,status=status,
                       image=image)
					   
					   
					   {% for i in prod %}
        <option value="{{ c.id }}">{{ i.cat_name }}</option>
    {% endfor %}
	
	
	
	
	def insertproductdata(request):
    name=request.POST.get("pname")
    cat_type=request.POST.get("pcat")
    price=request.POST.get("price")
    desc=request.POST.get("desc")
    status=request.POST.get("status")
    image=request.FILES["pimage"]


    insertquery=product(name=name,cat_type= Category(id=cat_type),price=price,desc=desc,status=status,
                       image=image)
    insertquery.save()
    messages.success(request,"product added successfully")
    return redirect("/")
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	////////////////////////pg myadmin4
	
	SELECT * FROM public.shopping_data

--Q.1.WHAT IS THE TOTAL REVENUE GENERATED BY MALE V/S FEMALE CUSTOMER?
SELECT "Gender", SUM("Purchase Amount (USD)") as revenue
FROM shopping_data
GROUP BY "Gender";


--Q.2 WHICH CUSTOMER USED A DISCOUNT BUT STILL SPENT MORE THEN THE AVERAGE PURVHASE AMOUNT?
SELECT "Customer ID", "Purchase Amount (USD)"
FROM shopping_data
WHERE "Discount Applied" = 'Yes' 
AND "Purchase Amount (USD)" >= (SELECT AVG("Purchase Amount (USD)") FROM shopping_data);

--Q.3 WHICH ARE THE TOP 5 PRODUCTS WITH THE HIGHEST AVERAGE REVIEW RATING?
SELECT "Item Purchased", AVG("Review Rating") as "Average Product Rating"
FROM shopping_data
GROUP BY "Item Purchased"
ORDER BY "Average Product Rating" DESC
LIMIT 5;



SELECT "Item Purchased", ROUND(AVG("Review Rating"::numeric), 2) as "Average Product Rating"
FROM shopping_data
GROUP BY "Item Purchased"
ORDER BY "Average Product Rating" DESC
LIMIT 5;

-- Q.4 Compare the average Purchase Amounts between Standard and Express Shipping.
SELECT "Shipping Type", ROUND(AVG("Purchase Amount (USD)"::numeric), 2) as "Average Purchase"
FROM shopping_data
WHERE "Shipping Type" IN ('Standard', 'Express')
GROUP BY "Shipping Type";


--Q.5 DO SUBSCRIBED CUSTOMERS SPEND MORE?COMPARE AVERAGE SPEND AND TOTAL REVENUE BETWEEN SUBSCRIBED AND NON SUBSCRIBED?

SELECT 
    "Subscription Status", 
    COUNT("Customer ID") as total_customers, 
    ROUND(AVG("Purchase Amount (USD)"::numeric), 2) as avg_spend, 
    ROUND(SUM("Purchase Amount (USD)"::numeric), 2) as total_revenue
FROM shopping_data
GROUP BY "Subscription Status"
ORDER BY total_revenue DESC;

-- Q6. Which 5 products have the highest percentage of purchases with discounts applied?
SELECT 
    "Item Purchased", 
    ROUND((SUM(CASE WHEN "Discount Applied" = 'Yes' THEN 1 ELSE 0 END)::numeric / COUNT(*)) * 100, 2) as discount_rate
FROM shopping_data
GROUP BY "Item Purchased"
ORDER BY discount_rate DESC
LIMIT 5;

-- Q7. Segment customers based on their total number of previous purchases
WITH customer_type AS (
    SELECT 
        "Customer ID", 
        "Previous Purchases",
        CASE 
            WHEN "Previous Purchases" = 1 THEN 'New'
            WHEN "Previous Purchases" BETWEEN 2 AND 10 THEN 'Returning'
            ELSE 'Loyal'
        END AS customer_segment
    FROM shopping_data
)
SELECT customer_segment, COUNT(*) as "Number of Customers"
FROM customer_type
GROUP BY customer_segment;


-- Q8. What are the top 3 most purchased products within each category?
WITH item_counts AS (
    SELECT 
        "Category", 
        "Item Purchased", 
        COUNT("Customer ID") as total_orders,
        ROW_NUMBER() OVER(
            PARTITION BY "Category" 
            ORDER BY COUNT("Customer ID") DESC
        ) as item_rank
    FROM shopping_data
    GROUP BY "Category", "Item Purchased"
)
SELECT item_rank, "Category", "Item Purchased", total_orders
FROM item_counts
WHERE item_rank <= 3;	


-- Q9. Are repeat buyers (more than 5 purchases) also likely to subscribe?
SELECT 
    "Subscription Status", 
    COUNT("Customer ID") as repeat_buyers
FROM shopping_data
WHERE "Previous Purchases" > 5
GROUP BY "Subscription Status";

-- Q10. What is the revenue contribution of each age group?
SELECT 
    CASE 
        WHEN "Age" BETWEEN 18 AND 30 THEN '18-30'
        WHEN "Age" BETWEEN 31 AND 50 THEN '31-50'
        ELSE '51+' 
    END AS age_group,
    SUM("Purchase Amount (USD)") as total_revenue
FROM shopping_data
GROUP BY age_group
ORDER BY total_revenue DESC;


-- Q10. What is the revenue contribution of each age group?
SELECT 
    CASE 
        WHEN "Age" BETWEEN 18 AND 30 THEN 'Young Adult'
        WHEN "Age" BETWEEN 31 AND 50 THEN 'Middle-aged'
        WHEN "Age" BETWEEN 51 AND 65 THEN 'Adult'
        ELSE 'Senior' 
    END AS age_group_category,
    SUM("Purchase Amount (USD)") as total_revenue
FROM shopping_data
GROUP BY age_group_category
ORDER BY total_revenue DESC;